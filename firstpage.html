<!DOCTYPE html>
<html>
	<head>
        <title>Make My Journey</title>
    <!-- for-mobile-apps -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#25274d">
    <meta name="description" content="Make My Journey">
    <meta name="author" content="James Muriitih">
    <meta name="keywords" content="bus,bus seats,">
    <meta property="og:site_name" content="google.com">
    <meta property="og:title" content="Bus Seat Reservation System" />
    <meta property="og:description" content="Hotel Recommendation system" />
 <!--    <meta property="og:image" content="https://james-muriithi.github.io/bus/images/logo-400.png" />
    <meta property="og:image:url" content="https://james-muriithi.github.io/bus/images/logo-400.png" />
    <meta property="og:image:secure_url" content="https://james-muriithi.github.io/bus/images/logo-400.png" /> -->
    <!-- <meta property="og:image:type" content="image/png" /> -->
    <meta property="og:image:width" content="400" />
    <meta property="og:image:height" content="400" />
    <meta property="og:locale" content="en_GB" />
    <meta property="og:type" content="website" />
    <meta name="application-name" content="My Bus" />
    <meta name="apple-mobile-web-app-title" content="My Bus" />
    <meta name="msapplication-TileColor" content="#2b5797" />

    <!-- //for-mobile-apps -->
    <title>Make My Journey</title>
    <!-- icons -->
    <link rel="icon" type="image/png" href="lohot.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="lohot.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="lohot.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="lohot.png" sizes="64x64" />
    <link rel="icon" type="image/png" href="lohot.png" sizes="128x128" />
    <link rel="apple-touch-icon" sizes="120x120" href="../lohot.png" />
    <link rel="mask-icon" href="images/safari-pinned-tab.svg" color="#5bbad5" />
    <link rel="manifest" href="site.webmanifest">
    <!-- end of icons  -->
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrapValidator.css">
    <link rel="stylesheet" type="text/css" href="css/nice-select.css">
    <link rel="stylesheet" type="text/css" href="css/util.css">
    <link rel="stylesheet" type="text/css" href="css/jquery.seat-charts.css">
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome/css/font-awesome.min.css">
    <link href="fonts/material-design-icons/material-icon.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="plugins/material-datetimepicker/bootstrap-material-datetimepicker.css" />
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/material.min.css">
    <link rel="stylesheet" type="text/css" href="plugins/lobibox/css/lobibox.min.css">
    <link rel="stylesheet" type="text/css" href="css/simplelightbox.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

	<title>	</title>
</head>

<body>
	 
     <style type="text/css">

  body:before {
  content: "";
  position: absolute;
  top: -10px;
  left: -10px;
  right: -10px;
  bottom: -10px;
  z-index: -1;
  opacity: 0.3;
  background-image: url("https://d22109rw628vry.cloudfront.net/blog/articles/TCXVP8yGG5.jpg");
  background-repeat: repeat;
}

         body{
            background-color: #ffffff;
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25'%3E%3Cdefs%3E%3ClinearGradient id='a' gradientUnits='userSpaceOnUse' x1='0' x2='0' y1='0' y2='100%25' gradientTransform='rotate(240)'%3E%3Cstop offset='0' stop-color='%23ffffff'/%3E%3Cstop offset='1' stop-color='%234FE'/%3E%3C/linearGradient%3E%3Cpattern patternUnits='userSpaceOnUse' id='b' width='540' height='450' x='0' y='0' viewBox='0 0 1080 900'%3E%3Cg fill-opacity='0.1'%3E%3Cpolygon fill='%23444' points='90 150 0 300 180 300'/%3E%3Cpolygon points='90 150 180 0 0 0'/%3E%3Cpolygon fill='%23AAA' points='270 150 360 0 180 0'/%3E%3Cpolygon fill='%23DDD' points='450 150 360 300 540 300'/%3E%3Cpolygon fill='%23999' points='450 150 540 0 360 0'/%3E%3Cpolygon points='630 150 540 300 720 300'/%3E%3Cpolygon fill='%23DDD' points='630 150 720 0 540 0'/%3E%3Cpolygon fill='%23444' points='810 150 720 300 900 300'/%3E%3Cpolygon fill='%23FFF' points='810 150 900 0 720 0'/%3E%3Cpolygon fill='%23DDD' points='990 150 900 300 1080 300'/%3E%3Cpolygon fill='%23444' points='990 150 1080 0 900 0'/%3E%3Cpolygon fill='%23DDD' points='90 450 0 600 180 600'/%3E%3Cpolygon points='90 450 180 300 0 300'/%3E%3Cpolygon fill='%23666' points='270 450 180 600 360 600'/%3E%3Cpolygon fill='%23AAA' points='270 450 360 300 180 300'/%3E%3Cpolygon fill='%23DDD' points='450 450 360 600 540 600'/%3E%3Cpolygon fill='%23999' points='450 450 540 300 360 300'/%3E%3Cpolygon fill='%23999' points='630 450 540 600 720 600'/%3E%3Cpolygon fill='%23FFF' points='630 450 720 300 540 300'/%3E%3Cpolygon points='810 450 720 600 900 600'/%3E%3Cpolygon fill='%23DDD' points='810 450 900 300 720 300'/%3E%3Cpolygon fill='%23AAA' points='990 450 900 600 1080 600'/%3E%3Cpolygon fill='%23444' points='990 450 1080 300 900 300'/%3E%3Cpolygon fill='%23222' points='90 750 0 900 180 900'/%3E%3Cpolygon points='270 750 180 900 360 900'/%3E%3Cpolygon fill='%23DDD' points='270 750 360 600 180 600'/%3E%3Cpolygon points='450 750 540 600 360 600'/%3E%3Cpolygon points='630 750 540 900 720 900'/%3E%3Cpolygon fill='%23444' points='630 750 720 600 540 600'/%3E%3Cpolygon fill='%23AAA' points='810 750 720 900 900 900'/%3E%3Cpolygon fill='%23666' points='810 750 900 600 720 600'/%3E%3Cpolygon fill='%23999' points='990 750 900 900 1080 900'/%3E%3Cpolygon fill='%23999' points='180 0 90 150 270 150'/%3E%3Cpolygon fill='%23444' points='360 0 270 150 450 150'/%3E%3Cpolygon fill='%23FFF' points='540 0 450 150 630 150'/%3E%3Cpolygon points='900 0 810 150 990 150'/%3E%3Cpolygon fill='%23222' points='0 300 -90 450 90 450'/%3E%3Cpolygon fill='%23FFF' points='0 300 90 150 -90 150'/%3E%3Cpolygon fill='%23FFF' points='180 300 90 450 270 450'/%3E%3Cpolygon fill='%23666' points='180 300 270 150 90 150'/%3E%3Cpolygon fill='%23222' points='360 300 270 450 450 450'/%3E%3Cpolygon fill='%23FFF' points='360 300 450 150 270 150'/%3E%3Cpolygon fill='%23444' points='540 300 450 450 630 450'/%3E%3Cpolygon fill='%23222' points='540 300 630 150 450 150'/%3E%3Cpolygon fill='%23AAA' points='720 300 630 450 810 450'/%3E%3Cpolygon fill='%23666' points='720 300 810 150 630 150'/%3E%3Cpolygon fill='%23FFF' points='900 300 810 450 990 450'/%3E%3Cpolygon fill='%23999' points='900 300 990 150 810 150'/%3E%3Cpolygon points='0 600 -90 750 90 750'/%3E%3Cpolygon fill='%23666' points='0 600 90 450 -90 450'/%3E%3Cpolygon fill='%23AAA' points='180 600 90 750 270 750'/%3E%3Cpolygon fill='%23444' points='180 600 270 450 90 450'/%3E%3Cpolygon fill='%23444' points='360 600 270 750 450 750'/%3E%3Cpolygon fill='%23999' points='360 600 450 450 270 450'/%3E%3Cpolygon fill='%23666' points='540 600 630 450 450 450'/%3E%3Cpolygon fill='%23222' points='720 600 630 750 810 750'/%3E%3Cpolygon fill='%23FFF' points='900 600 810 750 990 750'/%3E%3Cpolygon fill='%23222' points='900 600 990 450 810 450'/%3E%3Cpolygon fill='%23DDD' points='0 900 90 750 -90 750'/%3E%3Cpolygon fill='%23444' points='180 900 270 750 90 750'/%3E%3Cpolygon fill='%23FFF' points='360 900 450 750 270 750'/%3E%3Cpolygon fill='%23AAA' points='540 900 630 750 450 750'/%3E%3Cpolygon fill='%23FFF' points='720 900 810 750 630 750'/%3E%3Cpolygon fill='%23222' points='900 900 990 750 810 750'/%3E%3Cpolygon fill='%23222' points='1080 300 990 450 1170 450'/%3E%3Cpolygon fill='%23FFF' points='1080 300 1170 150 990 150'/%3E%3Cpolygon points='1080 600 990 750 1170 750'/%3E%3Cpolygon fill='%23666' points='1080 600 1170 450 990 450'/%3E%3Cpolygon fill='%23DDD' points='1080 900 1170 750 990 750'/%3E%3C/g%3E%3C/pattern%3E%3C/defs%3E%3Crect x='0' y='0' fill='url(%23a)' width='100%25' height='100%25'/%3E%3Crect x='0' y='0' fill='url(%23b)' width='100%25' height='100%25'/%3E%3C/svg%3E");
background-attachment: fixed;
background-size: cover;
         }
     </style>
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>

	 <nav class="navbar navbar-expand-lg navbar-dark static-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <h1>
                    <!-- <img src="images/p1.png" alt="logo" width="120" height="55" style="margin-top: -10px"> -->
                   <span>J</span>
                    <span>O</span>
                    <span>U</span>
                       <span>R</span>
                         <span>N</span>
                            <span>E</span>   
                            <span>Y</span>
                </h1>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <!-- <li class="nav-item active">
                        <a class="nav-link" href="#">Reprint
                            <span class="sr-only">(current)</span>
                        </a>
                    </li> -->
                    <li class="nav-item">
                        <a href="index.html"><button class="btn btn-outline-warning my-2 my-sm-0 ml-3" type="submit">Login</button></a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html"> <button class="btn btn-outline-warning my-2 my-sm-0 ml-2" type="submit">Sign Up</button></a>
                    </li>
                    <!-- <li class="nav-item">
              <a class="nav-link" href="#">Contact</a>
            </li> -->
                </ul>
            </div>
        </div>
    </nav>
    <!-- </navbar -->
    <!-- main content -->
    <main class="col-md-12">
        <div class="col-md-11 col-lg-9 col-xl-8 mx-auto window">
       <section class="stepper">

                <ul id="progressbar" style="padding-inline-start:8px;">
                                                      <img  src="lohot.png" alt="logo" width="100" height="100" style="margin-top: -10px">

                <a href="firstpage.html"> <li  class="active">Passenger Details</li> </a>
                <a href="Hotel/index.html" target="_blank"> <li> Reserve Hotel &nbsp; &nbsp; &nbsp;</li> </a>                    
                <a href="food.html" target="_blank"> <li>  Order Food &nbsp; &nbsp; &nbsp;</li> </a>
                <a href="Cab/index.html" target="_blank" > <li> Book Cab</li> </a>
                <a href="fetch.html"> <li> Ticket </li> </a>
                </ul>
            </section> 
            <section class="body">
                <form id="my-form">
                    <fieldset class="animated fadeIn">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="dropdown1">From</label>
                                <input type="text"   id="dropdown1"  class="form-control" name="from" placeholder="Chennai" id="from" required>

                               <!--  <select  id="dropdown1" class="form-control from " name="from" required>
                                    <option disabled>--PickUp Point--</option>
                                    <option value="Chennai">Chennai</option>
                                    <option value="Coimbatore">Coimbatore</option>
                                    <option value="Madurai">Madurai</option>
                                      <option value="Salem">Salem</option>
                                    <option value="Tirunelveli">Triunelveli</option> 
                                     <option value="Dindugal">Dindugal</option>
                                </select> -->

                                <!-- <p id="selected-option">hh</p> -->

                            </div>
                            <div class="form-group col-md-6">
                                <label for="dropdown2">To</label>
                                <input   id="dropdown2"  type="text" class="form-control" name="to" placeholder="Bombay" id="to" required>

                          </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label>Date of travel</label>
                                <input type="date" class="form-control" 
                                 value="2023-03-26" placeholder="2023-03-26" required>
                            </div>
                             <div class="form-group col-md-6">
                                <label>Total passengers</label>
                                <input type="number" class="form-control" id="passenger" name="passenger" value="1"
                                 oninput="updatePrice()">
                            </div> 
                            <div class="form-group col-md-6 ">
                                <label for="dropdown3">Checkin Time</label>
                                <input type="time"  id="dropdown3"  class="form-control"  value="10:00" id="appointment-time" name="appointment-time" required>

                            <!--     <select id="dropdown3" class="form-control time " name="time " required>
                                            <option disabled>--Time--</option>
                                            <option value="08:00">08:00</option>
                                            <option value="19:00">19:00</option>
                                            <option value="22:00 ">22:00</option>
                                        </select> -->
                            </div> 
                                    

                                        <div class="form-group col-md-6">
                                <label>Standard Price</label>
                                <input type="text" class="form-control" id="price" value="1250" name="price" readonly required>
                            </div>                

                        </div>
                   

                         <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="name">Full Name</label>
                                <input type="text" class="form-control" name="name" placeholder="Aravind" id="name" required>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="adhar">Adhar Number</label>
                                <input type="number" onblur="validateCardNumber()"  class="form-control" name="adhar" placeholder="631890872134" 
                                 id="adhar" required>
                            </div>
                                                  </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="phone">Mobile No.</label>
                                <input type="number" class="form-control" id="phone" name="phone" id="phone" placeholder="9677301246" onblur="validateMobileNumber()" required>
                            </div>
                            <!-- <input type="text" id="mobile-number" name="mobile-number" onblur="validateMobileNumber()"> -->
                        
                            <div class="form-group col-md-6">
                                <label for="email">Email</label>
                                <input type="email" class="form-control" id="email" name="email" placeholder="aravind@gmail.com" required>
                            </div>
                        </div>
                        <div class="row justify-content-center buttons">
                            <!-- <button type="submit " class="btn next_button">Submit</button> -->

     <div class="row justify-content-center buttons">
        <a href="index.html">
            <span id="mobile-number-error" style="color:red;"></span>

         <input class="btn btn-outline-warning my-2 my-sm-0 ml-2"  type="submit" />  

    <!-- <button  class="btn btn-outline-warning my-2 my-sm-0 ml-2" onclick="submit()" type="submit">Submit</button> -->
</a>
                        </div>

</div>

                    </fieldset>
                </form>
            </section>
        </div>
    </main>

</body>
<script>
      var config = {
    apiKey: "AIzaSyAi9tBGcAb65ALUMf8rx3F8hC_-Cb9ZBRw",
    authDomain: "hotel-multi.firebaseapp.com",
    databaseURL: "https://hotel-multi-default-rtdb.firebaseio.com",
    projectId: "hotel-multi",
    storageBucket: "hotel-multi.appspot.com",
    messagingSenderId: "663745625531",
    appId: "1:663745625531:web:1ada8df5190b0a948f989e"
  };


console.log("Hello");
firebase.initializeApp(config);
var database = firebase.database();


// const paragraph = document.querySelector('p');

// firebase.database().ref('users').on('child_added', (snapshot) => {
//   const values = snapshot.val();

//   // paragraph.textContent += `${values.dropdown1} - ${values.dropdown2} - ${values.dropdown3}\n`;
// });


// var hotel-form= document.getElementById('my-form');

// hotel-form.addEventListener('submit', function(event) {
//   event.preventDefault(); // Prevent the default form submission behavior

  
//   var checkin = document.getElementById("checkin").value;
//   var checkout     = document.getElementById("checkout").value;
  
 
//  console.log(checkin);
//   console.log(checkout);
//   // location.href = "availabletrain.html";
//   // Store the form data in Firebase
//   database.ref('users').push({
//     checkout : checkout, 
//     checkin  : checkin

//   });
// });




var form = document.getElementById('my-form');

form.addEventListener('submit', function(event) {
  event.preventDefault(); // Prevent the default form submission behavior

  var name  = form.elements['name'].value;
  var phone = form.elements['phone'].value;
  var email = form.elements['email'].value;
  var adhar = form.elements['adhar'].value;
 var dropdown1 = form.elements['dropdown1'].value; 
 var dropdown2 = form.elements['dropdown2'].value;
 var dropdown3 = form.elements['dropdown3'].value;

  // const dropdown1 = document.querySelector('#dropdown1');
  // const dropdown2 = document.querySelector('#dropdown2');
  // const dropdown3 = document.querySelector('#dropdown3');

  // var passenger = document.getElementById("passenger").value;
  // var price     = document.getElementById("price").value;
  

 var passenger = form.elements['passenger'].value;
var price = form.elements['price'].value;

 console.log(name);
 console.log(phone);
 console.log(email);
 console.log(adhar);
 console.log(dropdown1);
 console.log(dropdown2);
  console.log(dropdown3);

 console.log(passenger);
  console.log(price);


  // location.href = "hotel/index.html";
  window.open('hotel/index.html','_blank');
  // Store the form data in Firebase
  database.ref('users').push({
    name: name,
    phone : phone,
    email: email,
    adhar : adhar,
    price : price,
    passenger : passenger,
    dropdown1: dropdown1,
    dropdown2: dropdown2,
    dropdown3: dropdown3


  });
});

</script>
</html>
<script type="text/javascript " src="js/jquery.min.js "></script>
<script type="text/javascript " src="js/popper.min.js "></script>
<script type="text/javascript " src="js/bootstrap.min.js "></script>
<script type="text/javascript " src="js/bootstrapValidator.js"></script>
<script type="text/javascript " src="js/jquery-easing.min.js "></script>
<script type="text/javascript " src="js/jquery.nice-select.js "></script>
<script type="text/javascript " src="js/jquery.seat-charts.js "></script>
<script src="plugins/material-datetimepicker/moment-with-locales.min.js "></script>
<script src="plugins/material-datetimepicker/bootstrap-material-datetimepicker.js "></script>
<script src="plugins/material-datetimepicker/datetimepicker.js "></script>
<script type="text/javascript" src="js/simple-lightbox.min.js"></script>
<script type="text/javascript" src="plugins/lobibox/js/lobibox.min.js"></script>
<script type="text/javascript " src="js/script.js "></script>
<!-- <script type="text/javascript " src="multival.js"></script> -->
<script>
   
</script>
<script>                              
function validateMobileNumber() {
  const mobileNumber = document.getElementById("phone").value;
  const mobileNumberRegex = /^[0-9]{10}$/; // regular expression for 10 digit mobile number
  const errorSpan = document.getElementById("mobile-number-error");
  if (!mobileNumberRegex.test(mobileNumber)) {
    errorSpan.textContent = "Please enter a valid 10-digit mobile number.";
  } else {
    errorSpan.textContent = "";
    // do something with the valid mobile number
  }
}
          
function validateCardNumber() {
  const cardNumber = document.getElementById("adhar").value;
  const cardNumberRegex = /^\d{16}$/; // regular expression for 16-digit card number
  const errorSpan = document.getElementById("mobile-number-error");
  if (!cardNumberRegex.test(cardNumber)) {
    errorSpan.textContent = "Please enter a valid 16-digit Adhar number.";
  } else {
    errorSpan.textContent = "";
    // do something with the valid card number
  }
}

function updatePrice() {
  // Get the value of the age input field
  var age = document.getElementById("passenger").value;
  // console.log(age);
  // Calculate the price
  var price = age * 1250;

  // Update the value of the price input field
  document.getElementById("price").value = price;
}

</script>
<script type="text/javascript">




$('select').niceSelect();

$('.g-link').on('click', function(event) {
    $('.gallery1 a').trigger('click')
});

var $gallery = $('.gallery1 a').simpleLightbox();

//jQuery time
var current_fs, next_fs, previous_fs, busId=0,seatsArray = []; //fieldsets
var left, opacity, scale; //fieldset properties which we will animate
var animating; //flag to prevent quick multi-click glitches


$(".next_button").on('click', function(event) {

    if (animating) return false;
    animating = true;

    current_fs = $(this).parent().parent();
    next_fs = current_fs.next();

    if ($("fieldset").index(next_fs) == 1) {
        $('span.from').text($('select.from').val());
        $('span.to').text($('input.to').val());
        $.ajax({
            method: 'GET', //https://examinationcomplaint.theschemaqhigh.co.ke/HCI/api/book/
            url: 'https://examinationcomplaint.theschemaqhigh.co.ke/HCI/api/book/?bus_id=1&booked_seats',
            success: function (data) {
                $('span.seats-left').text(51 - data.length);
            },
            error: function (data) {
                console.log(data)
            }
        });

    }

    if ($("fieldset").index(current_fs) == 2) {
        if ($('ul#selected-seats li').length == 0) {
            animating = false;
            Lobibox.notify('error', {
                showClass: 'fadeInDown',
                hideClass: 'fadeUpDown',
                iconSource: 'fontAwesome',
                // img: 'images/logo-96.png',
                title: "No Seat Selected!",
                continueDelayOnInactiveTab: true,
                size: 'mini',
                msg: 'Please select at least one seat from the selected bus.'
            });

        } else {
            goNext(next_fs, current_fs)
            seatsArray.splice(0,seatsArray.length);
            sc.find('selected').each(function() {
                seatsArray.push(this.settings.label)
            });
        }
    } else if ($("fieldset").index(current_fs) == 3) {
        animating = false;
        if (!verifyInfoForm()) {

        } else {
            goNext(next_fs, current_fs)
            $('span.show-email').text($('input[name="email"]').val());
        }
    } else {
        goNext(next_fs, current_fs)
        if ($("fieldset").index(next_fs) == 5) {
            $data = {
                'busId' : busId,
                'seats' : seatsArray.toString(),
                'personalInfo' : $('form').serializeArray()
            }
            $data = JSON.stringify($data)
            console.log($data);
            $.ajax({
                method: 'POST',//https://examinationcomplaint.theschemaqhigh.co.ke/HCI/api/book/
                url: 'api/book.php',
                data: $data,
                dataType: 'json',
                success: function (data) {
                    console.log(data)
                },
                error: function (data) {
                    console.log(data)
                }
            });
        }
    }



    //     let date = $('#date').val();
    //     let regexp = /^(\d{4})[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;
    //     if (!regexp.test(date)) return 0;
    // }

    //go to next fs
    // $(".next_button").unbind('click',goNext(next_fs, current_fs));

});


$(".book_btn").click(function() {
    busId = Number($(this).data('bus')); //determine which bus was choosen
    let busName = $(this).parents('.bus-details').children('.bus-name').text();
    $('span.number_plate').text($(this).parents('.bus-details').children('.bus-name').text())
    if (animating) return false;
    animating = true;

    current_fs = $(this).parents('fieldset');
    next_fs = current_fs.next();

    if ($("fieldset").index(next_fs) == 2) {
        booked_seats(busId);
        setInterval( booked_seats(busId),3000);
    }

    //de-activate current step on progressbar
    goNext(next_fs, current_fs)

});

$(".previous_button").click(function() {

    current_fs = $(this).parent().parent();

    previous_fs = current_fs.prev();

    if ($("fieldset").index(previous_fs) == 2) {
        booked_seats(busId);
        setInterval( booked_seats(busId),3000);
    }

    //de-activate current step on progressbar
    if (previous_fs.length > 0) {
        if (animating) return false;
        animating = true;
        $("#progressbar li ").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();
        //hide the current fieldset with style
        current_fs.animate({
            opacity: 0
        }, {

            duration: 100,
            complete: function() {
                current_fs.hide();
                previous_fs.css('opacity', 1);
                animating = false;
            },
            //this comes from the custom easing plugin
            easing: 'easeInOutBack'
        });
    }
});

function goNext(next_fs, current_fs) {
    $("#progressbar li ").eq($("fieldset").index(next_fs)).addClass("active");
    //show the next fieldset
    next_fs.show();

    current_fs.animate({
        opacity: 0
    }, {
        duration: 10,
        complete: function() {
            current_fs.hide();
            animating = false;
        },
        //this comes from the custom easing plugin
        easing: 'easeInOutBack'
    });
}

function verifyInfoForm() {
    let name = $('input[name="name"]'),
    id = $('input[name="id"]'),
        phone = $('input[name="phone"]'),
        email = $('input[name="email"]'),
        nameRegexp = /^[a-zA-Z]+\s+[a-zA-Z\s]+$/,
        idRegexp = /^\d{4}$/,
        emailRegexp = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i,
        phoneRegexp = /^\d{10}$/,
        isValid = []
    if ($.trim(name.val()) == '') {
        name.addClass('is-invalid')
        name.parent().find('small.text-danger').remove()
        name.parent().append('<small class="text-danger">Name field cannot be empty</small>')
        isValid['name'] = false;
    } else if (!nameRegexp.test($.trim(name.val()))) {
        name.addClass('is-invalid')
        name.parent().find('small.text-danger').remove()
        name.parent().append('<small class="text-danger">Full name can only consist of alphabetical and atlest two names.</small>')
        isValid['name'] = false;
    } else {
        name.removeClass('is-invalid')
        name.addClass('is-valid')
        name.parent().find('small.text-danger').remove();
        isValid['name'] = true;
    }

    // phone no

    if ($.trim(phone.val()) == '') {
        phone.addClass('is-invalid')
        phone.parent().find('small.text-danger').remove()
        phone.parent().append('<small class="text-danger">Phone No field cannot be empty</small>')
        isValid['phone'] = false;
    } else if (!phoneRegexp.test($.trim(phone.val()))) {
        phone.addClass('is-invalid')
        phone.parent().find('small.text-danger').remove()
        phone.parent().append('<small class="text-danger">Please provide a valid phone number.</small>')
        isValid['phone'] = false;
    } else {
        phone.removeClass('is-invalid')
        phone.addClass('is-valid')
        phone.parent().find('small.text-danger').remove();
        isValid['phone'] = true;
    }
    // id
    if ($.trim(id.val()) == '') {
        id.addClass('is-invalid')
        id.parent().find('small.text-danger').remove()
        id.parent().append('<small class="text-danger">Id field cannot be empty</small>')
        isValid['id'] = false;
    } else if (!idRegexp.test($.trim(id.val()))) {
        id.addClass('is-invalid')
        id.parent().find('small.text-danger').remove()
        id.parent().append('<small class="text-danger">Please provide a valid ID number.</small>')
        isValid['id'] = false;
    } else {
        id.removeClass('is-invalid')
        id.addClass('is-valid')
        id.parent().find('small.text-danger').remove();
        isValid['id'] = true;
    }

    // email
    if ($.trim(email.val()) == '') {
        email.addClass('is-invalid')
        email.parent().find('small.text-danger').remove()
        email.parent().append('<small class="text-danger">Email field cannot be empty</small>')
        isValid['email'] = false;
    } else if (!emailRegexp.test($.trim(email.val()))) {
        email.addClass('is-invalid')
        email.parent().find('small.text-danger').remove()
        email.parent().append('<small class="text-danger">Please provide a valid email address.</small>')
        isValid['email'] = false;
    } else {
        email.removeClass('is-invalid')
        email.addClass('is-valid')
        email.parent().find('small.text-danger').remove();
        isValid['email'] = true;
    }

    return Object.values(isValid).every(function (value) {
        return value == true;
    });
}


$('#date_form').on('submit', (event) => {
    event.preventDefault();
})

$('ul#progressbar').on('click', 'li', function(event) {
    let i = $('#progressbar li').index(this)
    let j = $('#progressbar').find('li.active').length - 1

    if (i > j) {
        if (j == 1) {
            Lobibox.notify('error', {
                showClass: 'fadeInDown',
                hideClass: 'fadeUpDown',
                iconSource: 'fontAwesome',
                // img: 'images/logo-96.png',
                title: "No Train Selected!",
                continueDelayOnInactiveTab: true,
                size: 'mini',
                msg: 'Please select a Train from which you want to book.'
            });
        }else{
            $("fieldset").eq(j).find('.next_button').trigger('click')
        }
    }else if (i < j) $("fieldset").eq(j).find('.previous_button').trigger('click')

});
if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js')
            .then(function() {
                console.log("Service Worker Registered,");
            });
    });
}